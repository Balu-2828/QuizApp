<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sign Up - Quiz App</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
    <h2>Create an Account</h2>
    <form id="signupForm">
        <input type="text" id="username" placeholder="Username" required><br>

        <input type="password" id="password" placeholder="Password" required><br>

        <button type="submit">Sign Up</button>
    </form>
    <div id="message" style="text-align: center; margin-top: 15px;"></div>
    <p style="text-align: center; margin-top: 20px;">
        Already have an account? <a href="login.html">Log In</a>
    </p>
</div>

<script>
    const signupForm = document.getElementById('signupForm');
    const messageDiv = document.getElementById('message');

    signupForm.addEventListener('submit', async (event) => {
        event.preventDefault();

        // This line was failing because the element with id="username" didn't exist
        const username = document.getElementById('username').value;

        // This line was failing because the element with id="password" didn't exist
        const password = document.getElementById('password').value;

        const userData = {
            username: username,
            password: password,
            role: "USER"
        };

        try {
            const response = await fetch('/auth/signup', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(userData)
            });

            const resultText = await response.text();

            if (response.ok) {
                messageDiv.style.color = 'green';
                messageDiv.textContent = resultText + ". Please proceed to login.";
                signupForm.reset();
            } else {
                messageDiv.style.color = 'red';
                messageDiv.textContent = "Signup failed: " + resultText;
            }
        } catch (error) {
            console.error('Error:', error);
            messageDiv.style.color = 'red';
            messageDiv.textContent = "An error occurred. Please check the console.";
        }
    });
</script>
</body>
</html>